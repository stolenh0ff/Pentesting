import netifaces
import nmap
import os

os.system("clear")

sep=("------------------------------------------------------")

gw = netifaces.gateways()
gateway = gw['default'][netifaces.AF_INET][0]

def f_target():
    target = input(f"Set IP target (Your Actual Gateway is: {gateway}): ")
    if len(target) == 0:
        print("mount /dev/brain... you have to write an IP Address")
        f_target()
    else:
        target = target

def f_portbegin():
    portbegin = int(input("Set Port Begin: "))
    if len(portbegin) == 0:
        portbegin = "1"
    else:
        portbegin = portbegin

def f_portend():
    portend = int(input("Set Port End: "))
    if len(portend) == 0:
        portend = "443"
    else:
        portend = portend

def portscanner():
    scanner = nmap.PortScanner()

    print(sep)
    print("SCANNING PORTS")
    print(sep)
    
    for i in range(portbegin,portend+1):
        res = scanner.scan(target,str(i))
        res = res['scan'][target]['tcp'][i]['state']
        print(f'Port {i} is {res}.')

f_target()
f_portbegin()
f_portend()
portscanner()