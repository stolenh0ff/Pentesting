import webview
import os
from pyvis.network import Network
from icmplib import traceroute

ip_address = input("IPAddress: ")

def tracert():
    hops = traceroute(ip_address)
    #print('Distance/TTL\tAddress\t\t\tAverage round-trip time')
    last_distance = 0
    g = Network(height="750px", width="100%", bgcolor="#222222", font_color="white")
    n0de = 0
    #last_n0de = n0de - 1
    for hop in hops:
        dist = hop.distance
        addr = hop.address
        rtt = hop.avg_rtt
        if last_distance + 1 != dist:
            addr = "Unknown Address"
        #node creation
        g.add_node(n0de, value=100, color='#162347', label=f"IP Address: {addr}\nDistance: {dist}\nAverage RTT(ms): {rtt}")
        if n0de > 0:
            g.add_edge(n0de - 1, n0de)
        n0de += 1
        last_distance = dist
    #html page located in the same folder as the script
    g.toggle_physics(False)
    g.show("basic.html")
    webview.create_window('Network', 'basic.html')
    webview.start()

#exec
os.system("sudo rm basic.html")
os.system("clear")
tracert()