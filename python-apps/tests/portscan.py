# |jackcooper|
# Educational Purposes Only

import netifaces
import nmap
import os

def f_target():
    target = ""
    while len(target) == 0:
        target = input(f"Set IP target (Your Actual Gateway is: {gateway}): ")
        os.system("clear")
    return target

def f_portbegin():
    portbegin = int(input("Set Port Begin: ")or "1")
    return portbegin

def f_portend(portbegin):
    portend = int(input("Set Port End: ")or str(portbegin+1))
    return portend

def portscanner(target , portbegin , portend):

    scanner = nmap.PortScanner()

    print(sep)
    print("SCANNING PORTS")
    print(sep)
    
    for i in range(portbegin,portend+1):
        res = scanner.scan(target,str(i))
        res = res['scan'][target]['tcp'][i]['state']
        print(f'Port {i} is {res}.')

os.system("clear")

sep=("------------------------------------------------------")

gw = netifaces.gateways()
gateway = gw['default'][netifaces.AF_INET][0]

target = f_target()
portbegin = f_portbegin()
portend = f_portend(portbegin)
portscanner(target , portbegin , portend)