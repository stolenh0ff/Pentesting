from scapy.all import *
from scapy.layers.dot11 import Dot11, Dot11Elt

# Set your network interface in monitor mode
os.system("iwconfig YOUR_INTERFACE mode monitor")

def packet_handler(pkt):
    if pkt.haslayer(Dot11Elt) and pkt.type == 0 and pkt.subtype == 8:
        pmkid = pkt[Dot11Elt][2].info.hex()
        print(f"PMKID: {pmkid}")

# Sniff WiFi packets
sniff(iface="YOUR_INTERFACE", prn=packet_handler)
