import socket
import subprocess
import time

def scan_network():
    network_prefix = '192.168.1.'  # especifica el prefijo de la dirección IP de la red que quieres escanear
    for i in range(1, 255):
        ip_address = network_prefix + str(i)
        response = subprocess.call(['ping', '-c', '1', '-W', '1', ip_address], stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
        if response == 0:
            check_daemon(ip_address)

def check_daemon(ip_address):
    port = 9999
    timeout = 1  # especifica el tiempo de espera en segundos para establecer una conexión
    try:
        socket.setdefaulttimeout(timeout)
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((ip_address, port))
        s.close()
        print("Daemon está corriendo en: ", ip_address)
    except (socket.timeout, ConnectionRefusedError):
        pass

while True:
    scan_network()
    time.sleep(60)  # espera un minuto antes de escanear de nuevo
